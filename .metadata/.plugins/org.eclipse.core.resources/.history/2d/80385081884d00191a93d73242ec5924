package com.yoke;

import java.awt.Color;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JTextField;

/**
 * A class to prompt the user to select a keyboard combination
 */
public class KeyPressChooser extends JDialog {
    // The input field that shows the se'ected keys
    protected JTextField input; 
    
    // The keys that have been selected 
    protected List<Integer> keys;
    
    /**
     * Creates an instance of the keypress chooser
     */
    public KeyPressChooser() {
        super();
        setModal(true);
        
        // Create all functional components
        input = new JTextField();
        JButton ok = new JButton("OK");
        JButton cancel = new JButton("Cancel");
        
        // Setup the appropriate GUI structure
        this.add(input);
        this.setSize(200, 100);
        
        // Change the appearance a little
        input.setCaretColor(Color.white);
        
        // Handle inputs correctly
        input.addKeyListener(new KeyListener() {
            // The order of the modifier keys
            protected int[] modifiers = new int[] {KeyEvent.VK_CONTROL, KeyEvent.VK_SHIFT, KeyEvent.VK_ALT};
            
            // Counts the number of keys that are currently pressed
            protected int pressed = 0;
            
            @Override
            public void keyTyped(KeyEvent e) {
                // Prevent the key from changing the text
                e.consume();
            }
            
            @Override
            public void keyReleased(KeyEvent e) {
                pressed--;
            }
            
            @Override
            public void keyPressed(KeyEvent e) {
                if (pressed == 0) {
                    keys = new ArrayList<Integer>();
                }
                
                pressed++;
                
                
            }
        });
    }
    
    /**
     * Opens the dialog and returns the pressed key or null if cancelled
     * @return The selected keys
     */
    public List<Integer> showDialog() {
        setVisible(true);
        return keys;
    }
}
